{
    "contents" : "# =============================================================================\n# Stat 133: Final Project\n# Part 3 Data Visualization\n# Description: work with two csv files to produce images of the trajectory \n# of storms from 1980 to 2010 in both East Pacific and North Atlantic\n\n# Data: International Best Track Archive for Climate Stewardship (IBTrACS)\n# ftp://eclipse.ncdc.noaa.gov/pub/ibtracs/v03r06/wmo/csv/basin/\n# Basin.EP.ibtracs_wmo.v03r06.csv\n# ftp://eclipse.ncdc.noaa.gov/pub/ibtracs/v03r06/wmo/csv/basin/\n# Basin.NA.ibtracs_wmo.v03r06.csv\n\n# =============================================================================\n\n# Name:Tong Zhang 24540972, Zhiqiang Liao 24229382\n\n# =============================================================================\n# Load packages\n# =============================================================================\nlibrary(dplyr)\nlibrary(maps)\nlibrary(ggplot2)\nlibrary(stringr)\n\n# =============================================================================\n# Loading\n# =============================================================================\nEastP<-read.csv('rawdata/EastP.csv',skip = 1, header = TRUE)\nNorthA<-read.csv('rawdata/NorthA.csv', skip=1, header=TRUE)\n\n\n# =============================================================================\n# Preprocessing Data\n# =============================================================================\n\ncleanEP<-EastP[(as.character(EastP$Season)>='1980' & \n                as.character(EastP$Season)<= '2010'),]\ncleanNA<-NorthA[(as.character(NorthA$Season)>='1980' & \n                as.character(NorthA$Season)<= '2010'),]\n\n\n# =============================================================================\n# Change the format in each column\n# =============================================================================\ncleanEP$Latitude<-as.numeric(str_trim(as.character(cleanEP$Latitude), side='left'))\ncleanEP$Longitude<-as.numeric(str_trim(as.character(cleanEP$Longitude), side='left'))\ncleanEP$Wind.WMO.<-as.numeric(str_trim(as.character(cleanEP$Wind.WMO.), side='left'))\n\n\n# =============================================================================\n# Change the format in each column in North America Basin\n# =============================================================================\ncleanNA$Latitude<-as.numeric(str_trim(as.character(cleanNA$Latitude), side='left'))\ncleanNA$Longitude<-as.numeric(str_trim(as.character(cleanNA$Longitude), side='left'))\ncleanNA$Wind.WMO.<-as.numeric(str_trim(as.character(cleanNA$Wind.WMO.), side='left'))\n\n# =============================================================================\n# Combine the two data frame\n# =============================================================================\nclean<- full_join(cleanEP, cleanNA)\n\n# =============================================================================\n# Change Serial_Num column to factor\n# =============================================================================\nclean$Serial_Num<-as.factor(clean$Serial_Num)\n\n# =============================================================================\n# Extract Month\n# =============================================================================\nclean$Month<-str_replace_all(str_extract(as.character(clean$ISO_time),\n            '-[0-9]{2}-'),'-','')\nclean$Month<-factor(clean$Month, labels=month.name)\n\n# =============================================================================\n# gather world map data from maps package\n# =============================================================================\nmapData<-map_data('world')\n\n# =============================================================================\n# Visualization 1: Trajectory of storms from 1980 to 2010\n# =============================================================================\n\nglobalMap<- ggplot(clean, aes(x=Longitude, y=Latitude, group=Serial_Num)) +\n  geom_path(data=clean, aes(group=Serial_Num, colour=Wind.WMO.), alpha=0.5,size=0.5) +\n  geom_polygon(data=mapData, aes(x=long, y=lat, group=group),\n               fill='#000050', colour='#000050', size=0.5) +\n  ggtitle('Trajectory of storms from 1980 to 2010')+\n  scale_color_continuous(name='Wind (knot)',low = '#E68A00',high = '#4C2E00',\n                         space = 'Lab',guide = 'colourbar')+\n  xlim(-150, -25) + ylim(5, 60)+\n  theme(panel.background = element_rect(fill='#00006BDD',colour='#00006BDD'),\n        panel.grid = element_blank(),\n        panel.border = element_blank())\nglobalMap\n\npdf(\"images/globalMap.pdf\") # open device\nglobalMap # plot something \ndev.off() # close device\n\npng(\"images/globalMap.png\", width = 1024, height = 900, res= 120) # open device\nglobalMap # plot something \ndev.off() # close device\n# =============================================================================\n# Visualization 2 : Trajectory of storms per month from 1980 to 2010\n# (one facet per month)\n# =============================================================================\n\nstormByMonth <- ggplot(clean, aes(x=Longitude, y=Latitude, group=Serial_Num)) +\n  geom_path(data=clean, aes(group=Serial_Num, colour=Wind.WMO.), alpha=0.2,size=0.5) +\n  geom_polygon(data=map_data(\"world\"), aes(x=long, y=lat, group=group),\n               fill='#000050', colour='#000050', size=0.5) +\n  ggtitle('Trajectory of storms per month from 1980 to 2010')+\n  scale_color_continuous(name='Wind (knot)',low = '#E68A00',high = '#4C2E00',\n                         space = 'Lab',guide = 'colourbar')+\n  xlim(-150, -25) + ylim(5, 60)+facet_wrap(~ Month)+\n  theme(panel.background = element_rect(fill='#00006BDD',colour='#00006BDD'),\n        panel.grid = element_blank(),\n        panel.border = element_blank())\n\nstormByMonth\n\npdf(\"images/stormByMonth.pdf\") # open device\nstormByMonth # plot something \ndev.off() # close device\n\npng(\"images/stormByMonth.png\", width = 1024, height = 900, res= 120) # open device\nstormByMonth # plot something \ndev.off() # close device\n\n# =============================================================================\n# Visualization 3: trajectory of storms in decade 1980s \n# (one facet per year)\n# =============================================================================\n\n# extract storms from 1980 to 1989\ntraj1980<-clean[as.character(clean$Season)>='1980' & \n                as.character(clean$Season)<='1989',]\n\n# As. factor Season column in the data frame\ntraj1980$Season<-as.factor(traj1980$Season)\n\n# plot map\nmap1980 <- ggplot(traj1980, aes(x=Longitude, y=Latitude, group=Serial_Num)) +\n  geom_path(data=traj1980, aes(group=Serial_Num, colour=Wind.WMO.),alpha=0.2, size=0.5) +\n  geom_polygon(data=map_data(\"world\"), aes(x=long, y=lat, group=group),\n               fill='#000050', colour='#000050', size=0.5) +\n  ggtitle('Trajectory of storms per month from 1980 to 1989')+\n  scale_color_continuous(name='Wind (knot)',low = '#E68A00',high = '#4C2E00',\n                         space = 'Lab',guide = 'colourbar')+\n  xlim(-150, -25) + ylim(5, 60)+facet_wrap(~ Season)+\n  theme(panel.background = element_rect(fill='#00006BDD',colour='#00006BDD'),\n        panel.grid = element_blank(),\n        panel.border = element_blank())\n\nmap1980\n\npdf(\"images/stormsIn1980s.pdf\") # open device\nmap1980 # plot something \ndev.off() # close device\n\n\npng(\"images/stormsIn1980s.png\", width = 1024, height = 900, res= 120) # open device\nmap1980 # plot something \ndev.off() # close device\n\n# =============================================================================\n# Visualization 4: trajectory of storms in decade 1990s \n# (one facet per year)\n# =============================================================================\n\n# Extract storms from 1990 to 1999\ntraj1990<-clean[as.character(clean$Season)>='1990' & \n                as.character(clean$Season)<='1999',]\n\n# As. factor Season column in the storm data frame\ntraj1990$Season<-as.factor(traj1990$Season)\n\n# plot map\nmap1990 <- ggplot(traj1990, aes(x=Longitude, y=Latitude, group=Serial_Num)) +\n  geom_path(data=traj1990, aes(group=Serial_Num, colour=Wind.WMO.), \n            alpha=0.2, size=0.5)+\n  geom_polygon(data=map_data(\"world\"), aes(x=long, y=lat, group=group),\n               fill='#000050', colour='#000050', size=0.5) +\n  ggtitle('Trajectory of storms per month from 1990 to 1999')+\n  scale_color_continuous(name='Wind (knot)',low = '#E68A00',high = '#4C2E00',\n                         space = 'Lab',guide = 'colourbar')+\n  xlim(-150, -25) + ylim(5, 60)+facet_wrap(~ Season)+\n  theme(panel.background = element_rect(fill='#00006BDD',colour='#00006BDD'),\n        panel.grid = element_blank(),\n        panel.border = element_blank())\n\nmap1990\n\npdf(\"images/stormsIn1990s.pdf\") # open device\nmap1990 # plot something \ndev.off() # close device\n\npng(\"images/stormsIn1990s.png\", width = 1024, height = 900, res= 120) # open device\nmap1990 # plot something \ndev.off() # close device\n\n# =============================================================================\n# Visualization 5: trajectory of storms in decade 2000s \n# (one facet per year)\n# =============================================================================\n\n# Extract storms from 2000 to 2009\ntraj2000<-clean[as.character(clean$Season)>='2000' & \n                as.character(clean$Season)<='2009',]\n\n# As. factor Season column in the storm data frame\ntraj2000$Season<-as.factor(traj2000$Season)\n\n# plot map\nmap2000 <- ggplot(traj2000, aes(x=Longitude, y=Latitude, group=Serial_Num)) +\n  geom_path(data=traj2000, aes(group=Serial_Num, colour=Wind.WMO.),\n            alpha=0.2, size=0.5) +\n  geom_polygon(data=map_data(\"world\"), aes(x=long, y=lat, group=group),\n               fill='#000050', colour='#000050', size=0.5) +\n  ggtitle('Trajectory of storms per month from 2000 to 2009')+\n  scale_color_continuous(name='Wind (knot)',low = '#E68A00',high = '#4C2E00',\n                         space = 'Lab',guide = 'colourbar')+\n  xlim(-150, -25) + ylim(5, 60)+facet_wrap(~ Season)+\n  theme(panel.background = element_rect(fill='#00006BDD',colour='#00006BDD'),\n        panel.grid = element_blank(),\n        panel.border = element_blank())\n\nmap2000\n\npdf(\"images/stormsIn2000s.pdf\") # open device\nmap2000 # plot something \ndev.off() # close device\n\npng(\"images/stormsIn2000s.png\", width = 1024, height = 900, res= 120) # open device\nmap2000 # plot something \ndev.off() # close device\n\n",
    "created" : 1439608487216.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "101340136",
    "id" : "F87C60B3",
    "lastKnownWriteTime" : 1439599793,
    "path" : "~/Desktop/R/stat133_project/code/visual_code.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "type" : "r_source"
}